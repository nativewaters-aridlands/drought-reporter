<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Drought on Native Land<title>

            <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />

            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet/dist/leaflet.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-select/src/Leaflet.select.css" />
            <link rel='stylesheet' href="https://cdn.jsdelivr.net/npm/leaflet-fullscreen/dist/leaflet.fullscreen.css" />
            <link rel="stylesheet" href="https://cdn.maptiler.com/mapbox-gl-js/v1.5.1/mapbox-gl.css" />

            <style>
                #map {
                    position: absolute;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    left: 0;
                }
            </style>

</head>

<body>
    <div id="map"></div>

    <script src="https://cdn.jsdelivr.net/npm/leaflet/dist/leaflet.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/leaflet-fullscreen/dist/Leaflet.fullscreen.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/mapbox-gl/dist/mapbox-gl.js"></script>
    <script src="https://cdn.maptiler.com/mapbox-gl-leaflet/latest/leaflet-mapbox-gl.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        var promise = $.getJSON("native_land.geojson");

        promise.then(function(data) {

            var map = L.map('map', {
                maxZoom: 11,
                fullscreenControl: {
                    pseudoFullscreen: false
                },
                attributionControl: true
            }).fitBounds(
                [
                    [31, -120],
                    [42, -109]
                ]
            );



            var usdm = L.tileLayer.wms(
                "http://ndmc-001.unl.edu:8080/cgi-bin/mapserv.exe?map=/ms4w/apps/usdm/service/usdm_current_wms.map", {
                    layers: 'usdm_current',
                    format: 'image/png',
                    transparent: true,
                    zIndex: 0,
                    attribution: "US Drought Monitor"
                }).addTo(map);

            var hillshade = L.tileLayer(
                'https://api.maptiler.com/tiles/hillshades/{z}/{x}/{y}.png?key=KZO7rAv96Alr8UVUrd4a', {
                    opacity: 1,
                    zIndex: 50,
                    detectRetina: true,
                    attribution: ''
                });



            var labels = L.mapboxGL({
                attribution: "\u003ca href=\"https://www.maptiler.com/copyright/\" target=\"_blank\"\u003e\u0026copy; MapTiler\u003c/a\u003e \u003ca href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\"\u003e\u0026copy; OpenStreetMap contributors\u003c/a\u003e",
                style: 'https://api.maptiler.com/maps/f0c8face-73e4-41bb-b040-dd493150b9b1/style.json?key=KZO7rAv96Alr8UVUrd4a'
            });


            L.layerGroup([hillshade, labels])
                .addTo(map);

            function highlightFeature(e) {
                var layer = e.target;

                layer.setStyle({
                    weight: 2,
                    color: '#ffffff',
                    fillColor: '#000000',
                    fillOpacity: 0.5
                });

                if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                    layer.bringToFront();
                }
            }

            function resetHighlight(e) {
                nativeland.resetStyle(e.target);
            }

            var nativeland;

            function zoomToFeature(e) {
                map.fitBounds(e.target.getBounds());
            }

            function onEachFeature(feature, layer) {
                layer.on({
                    mouseover: highlightFeature,
                    mouseout: resetHighlight,
                    click: zoomToFeature
                });
            }

            nativeland = L.geoJson(data, {
                color: "#000000",
                fill: "#000000",
                fillOpacity: 0.1,
                weight: 1,
                onEachFeature: onEachFeature
            }).addTo(map);

            // var nativeland = L.geoJson(data, {
            // color: "#000000",
            // fill: null,
            // weight: 1
            // });
            // nativeland.addTo(map);
            nativeland.eachLayer(function(layer) {
                layer.bindTooltip(layer.feature.properties.NAME, {
                    sticky: true
                });
            });
        });
    </script>

</body>

</html>